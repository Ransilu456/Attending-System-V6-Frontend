var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,d=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&i(e,n,t[n]);if(r)for(var n of r(t))o.call(t,n)&&i(e,n,t[n]);return e},s=(e,r)=>t(e,n(r)),c=(e,t,n)=>new Promise(((r,a)=>{var o=e=>{try{d(n.next(e))}catch(t){a(t)}},i=e=>{try{d(n.throw(e))}catch(t){a(t)}},d=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,i);d((n=n.apply(e,t)).next())}));import{c as u,B as l}from"./index-BuwQNYxn.js";const p={getDailyReportPreview:(e,...t)=>c(void 0,[e,...t],(function*(e,t={}){return yield u.get("/reports/daily/preview",{params:e,headers:s(d({},t),{"preserve-mongodb-format":"true","time-format":"preserve-null","mongodb-date-format":"true","Content-Type":"application/json"})})})),getWeeklyReportPreview:(e,...t)=>c(void 0,[e,...t],(function*(e,t={}){return yield u.get("/reports/weekly/preview",{params:e,headers:s(d({},t),{"preserve-mongodb-format":"true","time-format":"preserve-null","mongodb-date-format":"true","Content-Type":"application/json"})})})),getMonthlyReportPreview:(e,...t)=>c(void 0,[e,...t],(function*(e,t={}){return yield u.get("/reports/monthly/preview",{params:e,headers:s(d({},t),{"preserve-mongodb-format":"true","time-format":"preserve-null","mongodb-date-format":"true","Content-Type":"application/json"})})})),getIndividualReportPreview:(e,...t)=>c(void 0,[e,...t],(function*(e,t={}){return yield u.get("/reports/individual/preview",{params:e,headers:s(d({},t),{"preserve-mongodb-format":"true","time-format":"preserve-null","mongodb-date-format":"true","Content-Type":"application/json"})})})),generateReport:(e,t,...n)=>c(void 0,[e,t,...n],(function*(e,t,n={}){const r={daily:"/reports/dailyAttendanceReport",weekly:"/reports/weeklyAttendanceReport",monthly:"/reports/monthlyAttendanceReport",individual:"/reports/individualStudentReport"};if(!r[e])throw new Error(`Unknown report type: ${e}`);return yield u.get(r[e],{params:t,responseType:"blob",headers:d({Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","Content-Type":"application/json","preserve-mongodb-format":"true","time-format":"preserve-null","mongodb-date-format":"true"},n)})}))},m={markAttendance:e=>{const t=s(d({},e),{deviceInfo:e.deviceInfo||navigator.userAgent,scanLocation:e.scanLocation||"Main Entrance"});return u.post("/admin/attendance",t)},markManualAttendance:(e,t,...n)=>c(void 0,[e,t,...n],(function*(e,t,n={}){var r,a;try{const r={studentId:e,status:t,deviceInfo:navigator.userAgent,scanLocation:n.location||"Manual Entry",adminNote:n.adminNote||"Manually marked by admin",sendNotification:!1!==n.sendNotification,date:n.date||(new Date).toISOString()},a=yield u.post("/admin/attendance",r);return 200!==a.status&&201!==a.status||l.success(`Student ${"entered"===t?"checked in":"left"===t?"checked out":"marked as "+t} successfully`),a.data}catch(o){throw l.error((null==(a=null==(r=o.response)?void 0:r.data)?void 0:a.message)||"Failed to mark attendance"),o}})),configureAutoCheckout:e=>c(void 0,null,(function*(){var t,n;try{const t=yield u.post("/admin/attendance/auto-checkout/configure",e);return 200===t.status&&l.success("Auto-checkout settings updated successfully"),t.data}catch(r){throw l.error((null==(n=null==(t=r.response)?void 0:t.data)?void 0:n.message)||"Failed to update auto-checkout settings"),r}})),getAutoCheckoutSettings:()=>c(void 0,null,(function*(){try{return(yield u.get("/admin/attendance/auto-checkout/settings")).data}catch(e){return{enabled:!1,time:"18:30",sendNotification:!0}}})),runAutoCheckout:()=>c(void 0,null,(function*(){var e,t;try{const e=yield u.post("/admin/attendance/auto-checkout/run");if(200===e.status){const{processed:t,failed:n}=e.data;l.success(`Auto-checkout completed: ${t} students processed, ${n} failed`)}return e.data}catch(n){throw l.error((null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.message)||"Failed to run auto-checkout"),n}})),markStudentAttendance:e=>{const t=s(d({},e),{deviceInfo:e.deviceInfo||navigator.userAgent,scanLocation:e.scanLocation||"Main Entrance"});return u.post("/admin/attendance/student",t)},markAttendanceByQR:e=>{const t={qrCodeData:e,deviceInfo:navigator.userAgent,scanLocation:"QR Scanner"};return u.post("/students/mark-attendance",t)},getTodayAttendance:()=>u.get("/admin/attendance/today"),getRecentAttendance:()=>u.get("/admin/attendance/recent"),getAttendanceByDate:e=>{const t=new Date(e).toISOString().split("T")[0];return u.get(`/admin/attendance/${t}`)},getAttendanceReport:e=>{const t=new Date(e).toISOString().split("T")[0];return u.get(`/admin/attendance/report?date=${t}`,{responseType:"arraybuffer",headers:{Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}})},get:(e,t={})=>u.get(e,t),getAllStudents:()=>u.get("/admin/students"),generateDailyReport:e=>p.generateReport("daily",e),generateWeeklyReport:e=>p.generateReport("weekly",e),generateMonthlyReport:e=>p.generateReport("monthly",e),generateIndividualReport:e=>p.generateReport("individual",e),getDailyReportPreview:e=>p.getDailyReportPreview(e),getWeeklyReportPreview:e=>p.getWeeklyReportPreview(e),getMonthlyReportPreview:e=>p.getMonthlyReportPreview(e),getIndividualReportPreview:e=>p.getIndividualReportPreview(e),getFormattedDate:e=>{if(!e)return"";const t=new Date(e);return isNaN(t.getTime())?"":t.toISOString().split("T")[0]},getDateRange:(e,t)=>({startDate:m.getFormattedDate(e),endDate:m.getFormattedDate(t)}),formatReportParams:e=>{const t=d({},e);return t.date&&(t.date=m.getFormattedDate(t.date)),t.startDate&&(t.startDate=m.getFormattedDate(t.startDate)),t.endDate&&(t.endDate=m.getFormattedDate(t.endDate)),t.includeEntryTime=!0,t.includeLeaveTime=!0,t.includeDuration=!0,t.includeLocation=!0,t},generateReport:(e,t,n={})=>p.generateReport(e.replace("AttendanceReport",""),t,n),canCheckOut:e=>{var t;if(!e)return!1;const n=new Date;n.setHours(0,0,0,0);const r=null==(t=e.attendanceHistory)?void 0:t.find((e=>{const t=new Date(e.date);return t.setHours(0,0,0,0),t.getTime()===n.getTime()}));return r&&("entered"===r.status||"present"===r.status)&&!r.leaveTime}};export{m as a,p as r};
